
<!DOCTYPE html>
<html>
  <head>
    <title>Simple Map</title>
    <meta name="viewport" content="initial-scale=1.0">
    <meta charset="utf-8">
    <style>
      /* Always set the map height explicitly to define the size of the div
       * element that contains the map. */
      #map {
        height: 100%;
      }
      /* Optional: Makes the sample page fill the window. */
      html, body {
        height: 100%;
        margin: 0;
        padding: 0;
      }
    </style>
  </head>
  <body>
    <div id="map"></div>
    <script>
      var map;
      function initMap() {
        map = new google.maps.Map(document.getElementById('map'), {
          center: {lat: {lat}, lng: {lng}},
          zoom: 8
        });
      }
      // The following example creates complex markers to indicate beaches near
// Sydney, NSW, Australia. Note that the anchor is set to (0,32) to correspond
// to the base of the flagpole.

function initMap() {
  var map = new google.maps.Map(document.getElementById('map'), {
    zoom: 10,
    center: {lat: -33.9, lng: 151.2}
  });

  setMarkers(map);
  get_route(map);
}

// Data for the markers consisting of a name, a LatLng and a zIndex for the
// order in which these markers should display on top of each other.
var beaches = [
  ['Bondi Beach', -33.890542, 151.274856, 4],
  ['Coogee Beach', -33.923036, 151.259052, 5],
  ['Cronulla Beach', -34.028249, 151.157507, 3],
  ['Manly Beach', -33.80010128657071, 151.28747820854187, 2],
  ['Maroubra Beach', -33.950198, 151.259302, 1]
];
  var marks = [
    {% for article in markers %}
        {% if not forloop.first %},{% endif %}
        {
            name: "{{ article.name }}",
            lat: "{{ article.lat }}",
            lan: "{{ article.lan }}",

        }
    {% endfor %}
    ]
   // console.log(marks)

function setMarkers(map) {
  for (var i = 0; i < marks.length; i++) {
    var pos = marks[i];

    var marker = new google.maps.Marker({
      position: {lat: Number(pos.lat), lng: Number(pos.lan)},
      map: map,
      //icon: image,
      //shape: shape,
      title: pos.name,
      //zIndex: beach[3]
    });
  }
}

function get_route(map){

  var directionsDisplay =new google.maps.DirectionsRenderer();
  var directionsService =new google.maps.DirectionsService();

  directionsDisplay.setMap(map);
  var from =new google.maps.LatLng(Number(marks[0].lat),Number(marks[0].lan));
  var to=   new google.maps.LatLng(Number(marks[1].lat),Number(marks[1].lan));

  var request={
      origin:from,
      destination: to,
      travelMode:'DRIVING'

  };
  directionsService.route(request, function(result, status){

      console.log(result, status);
      if(status=='OK'){
          directionsDisplay.setDirections(result);

      }

  });


}

    </script>
    <script src="https://maps.googleapis.com/maps/api/js?key=AIzaSyCMzgXhvxafDClVxRy5gkvDNbSmtBH3FcQ&callback=initMap"
    async defer>
      
    </script>
  </body>
</html>